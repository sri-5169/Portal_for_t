!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).exportFromJSON=n()}(this,function(){"use strict";function g(t){return"[object Array]"===Object.prototype.toString.call(t)}function O(t,n){if(!t)throw new Error(n)}function R(t){return Object.keys(t)}function U(n){return Object.keys(n).map(function(t){return[t,n[t]]})}function L(t,n,e){var r="."+n,n=new RegExp("(\\".concat(n,")?$"));return e(t).replace(n,r)}function a(t){return"555xmlHello .  world!".trim().replace(/^([0-9,;]|(xml))+/,""),t.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-")}function u(t){return Array(t+1).join(" ")}function i(t){return t.replace(/([<>&])/g,function(t,n){switch(n){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}})}function C(t,n,e,r){void 0===e&&(e="download");n=function(t,n,e){switch(n){case"txt":var r="text/plain;charset=utf-8";return e?URL.createObjectURL(new Blob([t],{type:r})):"data:,".concat(r)+encodeURIComponent(t);case"css":r="text/css;charset=utf-8";return e?URL.createObjectURL(new Blob([t],{type:r})):"data:,".concat(r)+encodeURIComponent(t);case"html":r="text/html;charset=utf-8";return e?URL.createObjectURL(new Blob([t],{type:r})):"data:,".concat(r)+encodeURIComponent(t);case"json":r="text/json;charset=utf-8";return e?URL.createObjectURL(new Blob([t],{type:r})):"data:,".concat(r)+encodeURIComponent(t);case"csv":r="text/csv;charset=utf-8";return e?URL.createObjectURL(new Blob([t],{type:r})):"data:,".concat(r)+encodeURIComponent(t);case"xls":r="text/application/vnd.ms-excel;charset=utf-8";return e?URL.createObjectURL(new Blob([t],{type:r})):"data:,".concat(r)+encodeURIComponent(t);case"xml":r="text/application/xml;charset=utf-8";return e?URL.createObjectURL(new Blob([t],{type:r})):"data:,".concat(r)+encodeURIComponent(t);default:return""}}(t,n,r=void 0===r?!0:r),r=document.createElement("a");r.href=n,r.download=e,r.setAttribute("style","visibility:hidden"),document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!1,view:window})),document.body.removeChild(r)}var E=function(){return(E=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function N(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,c=e.call(t),a=[];try{for(;(void 0===n||0<n--)&&!(r=c.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=c.return)&&e.call(c)}finally{if(o)throw o.error}}return a}function I(c){return c.map(U).reduce(function(t,n,o){return n.reduce(function(t,n){var e=N(n,2),r=e[0],n=e[1],e=t[r]||Array.from({length:c.length}).map(function(t){return""});return e[o]=("string"!=typeof n?JSON.stringify(n):n)||"",t[r]=e,t},t)},Object.create(null))}function S(t,n){return(n=void 0===n?function(t){return t}:n)(U(t).map(function(t){t=N(t,2);return{fieldName:t[0],fieldValues:t[1]}}))}function B(t,n){return t.length?'<html>\n  <head>\n    <meta charset="UTF-8" />\n  </head >\n  <body>\n    '.concat((n=n=void 0===n?function(t){return t}:n,O(0<(t=t).length),t=S(I(t),n),n=t.map(function(t){return t.fieldName}).join("</b></th><th><b>"),t=t.map(function(t){return t.fieldValues}).map(function(t){return t.map(function(t){return"<td>".concat(t,"</td>")})}).reduce(function(t,e){return t.map(function(t,n){return"".concat(t).concat(e[n])})}),"\n    <table>\n      <thead>\n        <tr><th><b>".concat(n,"</b></th></tr>\n      </thead>\n      <tbody>\n        <tr>").concat(t.join("</tr>\n        <tr>"),"</tr>\n      </tbody>\n    </table>\n  ")),"\n  </body>\n</html >\n"):""}function J(t){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>\n'.concat(function e(t,n,r,o){void 0===r&&(r="element");void 0===o&&(o=0);var c=a(n);n=u(o);if(null==t)return"".concat(n,"<").concat(c," />");t=g(t)?t.map(function(t){return e(t,r,r,o+2)}).join("\n"):"object"==typeof t?U(t).map(function(t){var n=N(t,2),t=n[0],n=n[1];return e(n,t,r,o+2)}).join("\n"):n+"  "+i(String(t));c="".concat(n,"<").concat(c,">\n").concat(t,"\n").concat(n,"</").concat(c,">");return c}(t,"base"),"\n")}function t(t){var n=t.data,e=t.fileName,r=void 0===e?"download":e,o=t.extension,c=t.fileNameFormatter,a=void 0===c?function(t){return t.replace(/\s+/,"_")}:c,u=t.fields,i=t.exportType,l=void 0===i?"txt":i,e=t.replacer,c=void 0===e?null:e,i=t.space,e=void 0===i?4:i,i=t.processor,f=void 0===i?C:i,i=t.withBOM,d=void 0!==i&&i,i=t.delimiter,s=void 0===i?",":i,t=t.beforeTableEncode,p=void 0===t?function(t){return t}:t,m="Invalid export data. Please provide an array of objects",h="Can't export unknown data type ".concat(l,"."),v="Can't export string data to ".concat(l,".");if("string"==typeof n)switch(l){case"txt":case"css":case"html":return f(n,l,L(r,null!=o?o:l,a));default:throw new Error(v)}var b,y,x=function(t){if(!t||g(t)&&!t.length||!g(t)&&!R(t).length)return function(t){return t};var r=g(t)?t.reduce(function(t,n){return E(E({},t),((t={})[n]=n,t))},Object.create(null)):t;return function(t){return g(t)?t.map(function(t){return U(t).reduce(function(t,n){var e=N(n,2),n=e[0],e=e[1];return n in r&&(t[r[n]]=e),t},Object.create(null))}).filter(function(t){return R(t).length}):U(t).reduce(function(t,n){var e=N(n,2),n=e[0],e=e[1];return n in r&&(t[r[n]]=e),t},Object.create(null))}}(u)(function(t){try{return"string"==typeof t?JSON.parse(t):t}catch(t){throw new Error("Invalid export data. Please provide a valid JSON")}}(n)),w=function(t,n,e){void 0===n&&(n=null);try{return JSON.stringify(t,n,e)}catch(t){throw new Error("Invalid export data. Please provide valid JSON object")}}(x,c,e);switch(l){case"txt":case"css":case"html":return f(w,l,L(r,null!=o?o:l,a));case"json":return f(w,l,L(r,null!=o?o:"json",a));case"csv":O(g(x),m);var j=(void 0===(y=s)&&(y=","),void 0===(j=p)&&(j=function(t){return t}),(b=x).length?(j=S(I(b),j)).map(function(t){return t.fieldName}).join(y)+"\r\n"+j.map(function(t){return t.fieldValues}).map(function(t){return t.map(function(t){return'"'.concat(t.replace(/\"/g,'""'),'"')})}).reduce(function(t,e){return t.map(function(t,n){return"".concat(t).concat(y).concat(e[n])})}).join("\r\n"):"");return f(d?"\ufeff"+j:j,l,L(r,null!=o?o:"csv",a));case"xls":return O(g(x),m),f(B(x,p),l,L(r,null!=o?o:"xls",a));case"xml":return f(J(x),l,L(r,null!=o?o:"xml",a));default:throw new Error(h)}}return t.types={txt:"txt",css:"css",html:"html",json:"json",csv:"csv",xls:"xls",xml:"xml"},t.processors={downloadFile:C},t});
